#!/usr/bin/env bash

set -e

release_info="$(cat /etc/*-release)"
echo "release_info=$release_info"
release_name="$(echo $release_info | cut -d'=' -f2)"

# Upgrade kernel on OS that require it
if [ $release_name != '"Debian GNU/Linux 8 (jessie)"']; then
  # it doesn't work on Debian, only Ubuntu. Might be better to whitelist Ubuntu. We'll see when testing on third OS
  apt-get install -yq \
    linux-image-extra-$(uname -r) 
fi

apt-get install -yq \
  build-essential \
  ca-certificates \
  curl \
  git \
  zlib1g \
  zlib1g-dev \
  libssl-dev \
  libxslt1-dev \
  module-init-tools \
  bridge-utils \
  openssh-server \
  openssl \
  perl \
  dnsmasq \
  procps \
  python-psycopg2 \
  python-software-properties \
  software-properties-common \
  python \
  python-dev \
  python-pip \
  iproute \
  libnetfilter-conntrack3 \
  libevent-dev \
  ebtables \
  vim \
  tmux

apt-get install -yq \
  cmake \
  libnl-3-dev \
  libnl-genl-3-dev \
  build-essential \
  pkg-config
